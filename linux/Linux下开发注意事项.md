# Linux 下开发注意事项

## fork 与 exec 的区别

fork 新建一个子进程，子进程会拷贝当前父进程的运行时状态数据，和父进程作为两个进程开始一样往下执行。

exec 直接调用两外一个程序执行，当前运行时状态数据会被调用的进程覆盖掉，程序id会保持不变。

## umask

会把当前用户创建文件/目录的权限减去 umask 设置的值，也可以说是把 umask 中设置的权限位代表的权限去掉。比如当前用户创建目录的权限为 0777，设置umask的值为 0002，那么最后创建出来的目录权限为 0775。

## restrict 关键字

关键字restrict只用于限定指针；该关键字用于告知编译器，所有修改该指针所指向内容的操作全部都是基于(base on)该指针的，即不存在其它进行修改操作的途径；这样的后果是帮助编译器进行更好的代码优化，生成更有效率的汇编代码。

## 读写锁与文件锁

读写锁用在线程间同步，通过 pthread_rwlock_xxx 相关函数控制

文件锁用在进程间同步，通过 fcntl 给文件加锁 F_SET_LOCK

## C/S B/S

C/S Client 客户端/ Server 服务器
优点： 1. 协议选用灵活 2. 缓存数据
缺点： 1. 对用户的安全构成威胁 2. 开发工作量较大，调试困难

B/S Browser 浏览器/ Server 服务器
优点： 1. 无需安装客户端 2. 跨平台
缺点： 1. 完整支持HTTP协议

## 物数/网/传/会表应

七层网络分层模型

## NAT 映射表

由接通互联网的路由器或交换机管理。主要是路由器的公网IP和内网不同电脑的IP：端口的映射。

## 打洞机制

[。。。](https://blog.csdn.net/znimade/article/details/72598555)

## 客户端/服务器

服务器：

1. socket 建立一个socket套接字
2. setsockopt 可选设置参数
3. bind 绑定待监听的IP地址和端口
4. listen 指定最大同时发起连接数量
5. accept 等待客户端的连接

客户端

1. socket 建立一个socket套接字
2. setsockopt 可选设置参数
3. bind 不用调，可依赖“隐示绑定”（随机端口）
4. connect 连接服务器

`nc` 命令可以简单测试

## select

文件描述符上限为 1024 个。 FD_SETSIZE

效率低，如只有 1 和 1000 时，需要循环1到1000。

原有集合需要保存。

## epoll

边沿触发： ET，没读完不会继续触发。  水平触发（默认）： LT 没读完的数据会继续触发

最优解： ET + IO非阻塞， fcntl 函数设置socket非阻塞读数据

epoll 反应堆模型： libevent 封装 epoll，全平台支持，源码需要阅读

## 广播与组播

192.168.xx.255 是广播播地址，服务器广播数据时发送到该地址上

192.168.xx.1 是网关，一般是交换机的地址

组播，需要客户端加入到特定的组，服务器向该组发送数据，广播的话服务器就向所有该网段上的机器发送数据。
