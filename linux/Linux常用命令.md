# Linux常用命令

## 基础信息

### 命令解析器

shell -- unix操作系统

bash -- Linux操作系统（b 人名缩写 a Again sh shell）

### 命令快捷键

```txt
命令和文件路径补全： Tab
上翻命令： ⬆️ / Ctrl + P
下翻命令： ⬇️ / Ctrl + N
光标移动：Ctrl + B / Ctrl + F  ||  Ctrl + A / Ctrl + E
删除字符：Backspace / Ctrl + H （前一字符） / Ctrl + D （后一字符） / Ctrl + U （删除行） / Ctrl + K （删除到行结尾）
清屏： Ctrl + L / clear
```

### history

```shell
$ history [n]   // 列出最近的 n 条命令行的意思
$ history [-c]  // 将目前 shell 中的所有 history 内容全部消除
$ history [-raw] histfiles
    -a          // 将目前新增的 history 命令新增入 histfiles 中，如没有加 histfiles，则默认写入 ~/.bash_history 。
    -r          // 将 histfiles 的内容读到目前这个 shell 的 history 记忆中。
    -w          // 将目前的 history 记忆写入 histfiles 中。
```

## 文件操作

tree 软件可以把目录按树结构展示

```txt
删除文件/目录： rm -r file/dir // -r 递归
新建目录： mkdir -p xxx
新建文件： touch
拷贝目录： copy src dist -r
```

### 查看文件内容

1. `cat`: 由第一行开始显示文件内容（所有）。
2. `tac`: 从最后一行开始显示，是`cat`的倒写。
3. `more`: 一页一页的显示文件内容。
4. **`less`**: 与`more`类似。 -- 重点
5. `head`: 只看头几行。
6. `tail`: 只看尾几行。

`more` 快捷键：

- **空格键(Space)** :代表向下翻页
- **b**             :向前翻页
- **Enter**         :代表向下滚动一行
- **/字符串**       :向下查询字符串
- **:f**            :立刻显示出文件名以及目前显示的行数
- **q**             :离开

`less` 快捷键--在`more`的基础上：

- **?字符串**:向上查询字符串

**注意：** -- 重点

- `tail -f [filename]` 持续检测文件内容，新加入的数据都会被显示到屏幕上。

### 查看文件类型

`file [filename]` 查看文件的基本数据，ASCII 或者 binary 或者 data 文件等。

### 文件名查找

`whereis [filename/directionary]` 寻找指定文件名的文件

`locate [filename/directionary]` 与上面一样，只是filename可以是“文件的部分名称”

`find [PATH] [option] [action]`

1. `find /etc -name "passwd*"` 查找文件名
2. `find /tmp -mtime -n` 查找n天内被修改过的文件
3. `find /home -user test` 查找属于test的文件
4. `find / -size +50k` 查找大于50KB的文件（- 对应小于)

### 文件内容查找

`grep` -r "查找内容" "查找路径"

### 压缩命令

常见扩展名

```sh
*.Z         compress 程序压缩的文件;
*.gz        gzip 程序压缩的文件；
*.bz2       bzip2 程序压缩的文件；
*.tar       tar 程序打包的数据，并没有压缩过；
*.tar.gz    tar 程序打包的文件，其中经过 gzip 的压缩；
*.tar.bz2   tar 程序打包的文件，其中经过 bzip2 的压缩；
```

#### 1. compress 已淘汰，不推荐使用

#### 2. gzip `# gzip [-cdtv#] 文件名`

```c
-c : 将压缩的数据输出到屏幕上，可通过数据流重定向来处理；
-d : 解压缩的参数；
-t : 可以用来检验一个压缩文件的一致性，看看文件有无错误；
-v : 可以显示出原文件/压缩文件的压缩比等信息；
-# : 压缩等级， -1 最快，但是压缩比最差， -9 最慢，但是压缩比最好。默认 -6

# gzip -v test                      // 压缩
# gzip -d test.gz                   // 解压缩
# gzip -9 -c test > test.gz         // 用最佳压缩比压缩，并保留原来的文件
```

#### 3. **bzip2** `# bzip2 [-cdkzv#] 文件名`

```c
-c : 将压缩过程中产生的数据输出到屏幕上；
-d : 解压缩的参数；
-k : 保留原文件，而不会删除原始的文件； // 与 gzip 的唯一区别
-z : 压缩的参数；
-v : 可以显示出原文件/压缩文件的压缩比等信息；
-# : 压缩等级， -1 最快，但是压缩比最差， -9 最慢，但是压缩比最好。默认 -6

# bzip2 -z test                     // 压缩
# bzip2 -d test.bz2                 // 解压缩
# bzip2 -9 -c test > test.bz2       // 用最佳压缩比压缩，并保留原来的文件
```

#### 4. tar

```c
-c : 【压缩】新建打包文件，可搭配 -v 来查看过程中被打包的文件名（filename）
-x ：【解压缩】解打包或解压缩的功能，可以搭配 -C 在特定目录解开
-v : 在压缩/解压缩的过程中，将正在处理的文件名显示出来
-f filename ：-f 后面要接被处理的文件名
// 不使用 z/j 参数，该命令只能对文件或目录打包
-z : 通过 gzip 的支持进行压缩/解压缩，此时文件名最好为 *.tar.gz
-j ：通过 bzip2 的支持进行压缩/解压缩，此时文件名最好为 *.tar.bz2

-t ：查看打包文件的内容含有哪些文件名，重点在查看文件名
-C 目录 : 这个参数用在解压缩时，若要在特定目录解压缩，可以使用这个参数
-p : 保留备份数据的原本权限与属性，常用于备份(-c)重要的配置文件
--exclude=FILE : 在压缩的过程中，不要将 FILE 打包

# tar -zpcv -f /root/etc.tar.gz /etc        // 打包压缩
# tar -jpcv -f /root/etc.tar.bz2 /etc       // 打包压缩
# tar -jtv -f /root/etc.tar.bz2             // 查看 tar 文件的数据内容（可查看文件名）
# tar -jxv -f /root/etc.tar.bz2             // 解压缩（数据在当前目录下）
# tar -jxv -f /root/etc.tar.bz2 -C /tmp     // 解压缩（数据在/tmp目录下）
```

#### 5. rar

```sh
rar -a 压缩 压缩包名字 压缩的文件或目录
rar -x 解压缩 压缩包名字 （路径）
```

#### 6. zip

```sh
zip 压缩包名字 压缩的文件或目录（目录需要加参数 -r）
unzip 压缩包的名字
unzip 压缩包的名字 -d 解压目录
```

## 文件系统相关指令

1. `df` 列出文件系统的整体磁盘使用量
    - `# df -h` 以易读的方式列出（不加参数也能用）

2. `fdisk` 磁盘分区的相关命令
    - `# fdisk -l` 列出系统内的所有设备分区

3. `mkfs` 磁盘格式化命令 `# mkfs -t ext3 /dev/sdb6`

4. `mount` 挂载设备 `-l` 显示目前挂载的信息（可不加参数）
    - `# mount /dev/sdb6 /mnt/sdb6` 把设备分区挂载到/mnt/sdb6上，可以是U盘、光盘之类的设备

5. `umount` 卸载设备
    - `# umount /dev/sdb6` 用设备文件名来卸载
    - `# umount /mnt/sdb6` 用挂载点来卸载

## 数据流重定向

1. `1>` （不写数字时默认）以覆盖的方法将正确的数据输出到指定的文件或设备上。
2. `1>>` （不写数字时默认）以累加的方法将正确的数据输出到指定的文件或设备上。
3. `2>` 以覆盖的方法将错误的数据输出到指定的文件或设备上。
4. `2>>` 以累加的方法将错误的数据输出到指定的文件或设备上。
5. `/dev/null` 垃圾桶黑洞设备
6. `> file 2>&1` 或者 `&> file` 将正确与错误的数据写入同一个文件中

## `$?`(命令回传码) 与 && 或 ||

```sh
1. 若前一个命令执行的结果为正确，在Linux下面会回传一个`$?=0`的值。
2. `cmd1 && cmd2`   若cmd1执行完毕且正确执行($?=0)，则开始执行cmd2；
                    若cmd1执行完毕且为错误($?/=0)，则cmd2不执行
3. `cmd1 || cmd2`   若cmd1执行完毕且正确执行($?=0)，则cmd2不执行；
                    若cmd1执行完毕且为错误($?/=0)，则开始执行cmd2
```

## 进程相关命令

### ps

```c
# ps aux    // 查看系统所有的进程数据
# ps -l     // 查看自己bash程序
# ps -lA    // 查看所有的进程数据，包括有PPID

参数
-A : 所有的进程均显示出来，与 -e 具有同样的作用；
-a : 不与 terminal 有关的进程；
-u : 有效用户 (effective user) 相关的进程；
x  : 通常与 a 这个参数一起使用，可列出教完整信息；
输出格式规划
l  : 较长、较详细地将该 PID 的信息列出；
j  : 工作的格式 (jobs format) ；
-f : 做一个更为完整的输出；
```

### top

```sh
top 持续检测进程运行的状态
$ top [-t 数字] | top [-bnp]
-d ：后面可以接秒数，就是整个进程界面更新的秒数。默认是5秒。
-b ：以批次的方式执行 top，还有更多的参数可以使用。通常会搭配数据流重定向来将批处理的结果输出成为文件。
-n ：与 -b 搭配，意义是，需要进行几次 top 的输出结果。
-p ：制定某些个 PID 来进行查看监测而已。
```

### kill

```sh
$ kill -l   // 查看进程可用的信号(signal)
$ kill -signal PID  // 将 signal 传送给某个工作(%jobnumber)或者是某个PID
$ kill -signal_name PID // -l 查询出来的 signal_name，一般与数字一一对应

常用的 signal ：
1 ：启动被终止的进程，可让改PID重新读取自己的配置文件，类似重新启动。
9 ：代表强制中断一个进程的进行。
15：以正常的结束进程来终止该进程。
```

### env

查看当前的环境变量

## 系统资源查看相关命令

### 1. `free`查看内存使用情况

```sh
$ free [-b|-k|-m|-g] [-t]
-b : 直接输入 free 时，显示的单位是 KB 我们可以使用b(bytes),m(MB),k(KB),g(GB)来显示单位。
-t : 在输出的最终结果中显示物理内存与swap的总量。
```

### 2. `unmae`查看系统与内核相关的信息

```sh
$ uname [-asrmpi]
-a ：所有系统相关的信息，包括下面的数据都会被列出来；
-s ：系统内核名称；
-r ：内核的版本；
-m ：本系统的硬件名称，例如 i686 或 x86_64 等；
-p ：CPU 的类型，与 -m 类似，只是显示的是 CPU 的类型；
-i ：硬件的平台（ix86）。
```

### 3. `uptime`查看系统启动时间与工作负载

## 网络操作

### `netstat`跟踪网络

```sh
$ netstat -[atunlp]
-a ：将目前系统上所有的连接、监听、Socket 数据都列出来；
-t ：列出 tcp 网络数据包的数据；
-u ：列出 udp 网络数据包的数据；
-n ：不列出进程的服务名称，以端口号（port number）来显示；
-l ：列出目前正在网络监听（listen）的服务；
-p ：列出网络服务的进程 PID。
```

### nslookup

查看服务器域名对应的IP地址

### scp

超级拷贝，拷贝远程主机上的文件/目录到本地主机上

scp -r 目标用户名@目标主机IP地址:/目标文件的绝对路径 /保存到本机的绝对路径

## vim 文本编辑器

### 1. 命令模式下

光标移动

1. 左上下右： hjkl
2. 行首：0
3. 行尾：$
4. 文件开始位置： gg
5. 文件末尾：G
6. 行跳转： 5G

删除操作

1. 删除光标后面的字符： x
2. 删除光标前面的字符： X
3. 删除单词： dw
4. 删除当前行： dd
5. 删除多行： ndd
6. 删除光标到行首：d0
7. 删除光标到行尾：d$（D）

撤销操作

1. 撤销： u
2. 反撤销： ctrl + r

复制粘贴

1. 复制：yy
2. 复制多行： nyy
3. 粘贴： p（光标下一行开始粘贴）
4. 粘贴： P（光标当前行开始粘贴）

### 2. 可视模式

命令模式下按 `v` 进入可视模式

1. 选择内容： hjkl
2. 复制：y
3. 删除：d

### 3. 查找模式

1. /hello 向下查找 hello 字符串
2. ?hello 向上查找 hello 字符串
3. \# 把光标移到查找的单词身上，按 \#
4. 遍历查找的内容： n/N

缩进： >> 或 <<

### 4. 编辑模式

1. a： 从光标后面插入
2. A： 从当前行行尾插入
3. i： 从光标前面插入
4. I： 从光标行行首插入
5. o： 从下一行开始一个新的行
6. O： 从上一行开始一个新的行

### 5. 末行模式

1. 当前行查找 tom 并全部替换成 jack： :s/tom/jack/g
2. 文件所有 tom 并全部替换成 jack： :%s/tom/jack/g
3. 20-25行查找 tom 并全部替换成 jack： :20.25s/tom/jack/g
4. 执行一个命令： !输入命令

### 5. 分屏功能

1. 水平分屏（上下两部分）： sp
2. 垂直分屏（左右两部分）： vsp
3. 分屏打开另一个文件：sp/vsp 文件名
4. 切换两个屏幕：ctrl + ww
5. 保存退出所有屏幕： wqall

## gcc

1. 预处理 gcc -E
2. 编译 gcc -S
3. 汇编 gcc -c
4. 链接 gcc

参数：

1. -o： 指定生成的文件名字
2. -D： 在编译时定义宏
3. -I： 指定头文件的路径
4. -g： gdb调试时需要添加该参数
5. -O： 编译优化，3个等级 -O(1-3)
6. -Wall： 编译期间输出警告信息
